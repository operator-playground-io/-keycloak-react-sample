(this["webpackJsonpedge-keycloak2"]=this["webpackJsonpedge-keycloak2"]||[]).push([[0],{88:function(e,t,n){},89:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),r=n(18),a=n.n(r),s=n(8),l=n.n(s),i=n(15),j=n(23),u=n(47),d=n.n(u),b="GET_MESSAGES",O="SET_TOKEN",h="GET_USER",x="CLEAR_USER",g="SET_ERROR",p="CLEAR_ERROR",f="SET_LOADING",v=n(9),E=function(e,t){switch(console.log("state: ",e,", action: ",t),t.type){case b:return Object(v.a)(Object(v.a)({},e),{},{messages:t.payload,loading:!1});case O:return Object(v.a)(Object(v.a)({},e),{},{token:t.payload});case h:return Object(v.a)(Object(v.a)({},e),{},{user:t.payload,loading:!1});case x:return Object(v.a)(Object(v.a)({},e),{},{user:{}});case g:return Object(v.a)(Object(v.a)({},e),{},{loading:!1,error:t.payload});case p:return Object(v.a)(Object(v.a)({},e),{},{error:null});case f:return Object(v.a)(Object(v.a)({},e),{},{loading:!0});default:return e}},k=Object(c.createContext)(),y=n(1),_=function(e){var t=Object(c.useReducer)(E,{messages:[],token:null,user:{},loading:!1,error:null,operation:"/messages"}),n=Object(j.a)(t,2),o=n[0],r=n[1],a=function(){var e=Object(i.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Get messages.."),T(),e.prev=2,console.log("Retrieve posts .."),e.next=6,d.a.get("https://jsonplaceholder.typicode.com/users/1/posts");case 6:t=e.sent,n=t.data,console.log("Data is:",n),r({type:b,payload:n}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(2),console.error(e.t0),console.error(e.t0.message),_(e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(i.a)(l.a.mark((function e(t,n){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Set token.."),c=o.token,r({type:O,payload:t}),!t){e.next=12;break}if(c===t){e.next=9;break}return e.next=7,u(n);case 7:e.next=10;break;case 9:console.log("Same token... No need to read user info...");case 10:e.next=13;break;case 12:v();case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=Object(i.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Get user info.."),T(),e.prev=2,e.next=5,t.loadUserInfo();case 5:n=e.sent,console.log("User profile:",n),r({type:h,payload:n}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0),console.error(e.t0.message),_(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){console.log("Clear user info.."),r({type:x})},_=function(e){r({type:g,payload:e}),setTimeout((function(){return R()}),5e3)},R=function(){r({type:p})},T=function(){r({type:f})};return Object(y.jsx)(k.Provider,{value:{messages:o.messages,token:o.token,user:o.user,loading:o.loading,error:o.error,getMessages:a,setToken:s},children:e.children})},R=n(16),T=n(5),m=n(17),A=n(49),L=n.n(A),C="production";console.log("NODE_ENV: ",C);var S=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTH_CLIENT:"vanilla",REACT_APP_AUTH_REALM:"myrealm",REACT_APP_AUTH_SERVER_URL:"http://localhost:8080/auth/"}),P=S.REACT_APP_AUTH_SERVER_URL,U=S.REACT_APP_AUTH_REALM,w=S.REACT_APP_AUTH_CLIENT;console.log("REACT_APP_AUTH_SERVER_URL: ",P),console.log("REACT_APP_AUTH_REALM: ",U),console.log("REACT_APP_AUTH_CLIENT: ",w);var I=window,H=I.SERVER_URL,K=I.REALM,N=I.CLIENT;console.log("SERVER_URL: ",H),console.log("REALM: ",K),console.log("CLIENT: ",N);var M=H,D=K,G=N;console.log("Backend URL: ",M),console.log("Backend REALM: ",D),console.log("Backend CLIENT: ",G);var V={realm:D,url:M,clientId:G};console.log("Keycloak params: ",V);var B=new L.a(V),z=n(93),W=n(91),F=n(92),J=n(94),Y=function(e){var t=Object(c.useState)("/"),n=Object(j.a)(t,2),o=n[0],r=n[1],a=Object(m.b)(),s=a.keycloak,u=a.initialized,d=Object(c.useContext)(k).user,b=s.authenticated,O=function(){var e=Object(i.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("login: ",t),t.preventDefault(),e.next=4,s.login();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(i.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("logout: ",t),t.preventDefault(),e.next=4,s.logout();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();console.log("userInfo:",d);var x=(console.log("Render auth links - initialized:",u,", authenticated: ",b),b?Object(y.jsxs)(W.a,{noGutters:!0,children:[Object(y.jsx)(F.a,{md:1,lg:1,xl:1,children:Object(y.jsx)(J.a.Item,{style:{textAlign:"left"},children:Object(y.jsx)(J.a.Link,{eventKey:"/",href:"/",as:"div",children:Object(y.jsx)(R.b,{to:"/",children:"Home"})})})}),Object(y.jsx)(F.a,{md:6,lg:6,xl:6,children:Object(y.jsx)(J.a.Item,{style:{textAlign:"left"},children:Object(y.jsx)(J.a.Link,{eventKey:"/posts",href:"/posts",as:"div",children:Object(y.jsx)(R.b,{to:"/posts",children:"Posts"})})})}),Object(y.jsx)(F.a,{md:4,lg:3,xl:3,children:Object(y.jsx)(J.a.Item,{children:Object(y.jsxs)(J.a.Link,{eventKey:"/logoff",href:"#",as:"div",disabled:!0,children:["Welcome ",d.name]})})}),Object(y.jsx)(F.a,{md:1,lg:2,xl:2,children:Object(y.jsx)(J.a.Item,{children:Object(y.jsx)(J.a.Link,{eventKey:"/logoff",href:"#",onClick:h,as:"div",children:Object(y.jsx)(R.b,{to:"/logoff",children:"Logout"})})})})]}):Object(y.jsxs)(W.a,{noGutters:!0,children:[Object(y.jsx)(F.a,{md:10,lg:10,xl:10,children:Object(y.jsx)(J.a.Item,{style:{textAlign:"left"},children:Object(y.jsx)(J.a.Link,{eventKey:"/",as:"div",children:Object(y.jsx)(R.b,{to:"/",children:"Home"})})})}),Object(y.jsx)(F.a,{md:2,lg:2,xl:2,children:Object(y.jsx)(J.a.Item,{children:Object(y.jsx)(J.a.Link,{eventKey:"/login",as:"div",href:"/#",onClick:O,children:Object(y.jsx)(R.b,{to:"/login",children:"Login"})})})})]}));return Object(y.jsx)(J.a,{defaultActiveKey:"/",activeKey:o,onSelect:function(e){console.log("select tab ",e),r(e)},style:{backgroundColor:"cyan"},children:Object(y.jsx)(z.a,{children:x})})},q=n(53),Q=function(){var e=Object(c.useContext)(k).error;return e&&Object(y.jsx)(q.a,{variant:"danger",style:{marginTop:"50px"},children:e})},X=function(e){return Object(y.jsx)("div",{children:"This is a public page. Click on the Login link to authenticate and see the list of posts."})},Z=n(20),$=function(e){var t=Object(m.b)(),n=t.keycloak,o=t.initialized,r=Object(c.useContext)(k),a=r.messages,s=r.getMessages,l=r.loading,i=n.authenticated;return Object(c.useEffect)((function(){return s()}),[]),console.log("initialized:",o,", authenticated: ",i),console.log("Posts: ",a),i?l?Object(y.jsx)("div",{children:"Loading posts..."}):a&&0!==a.length?Object(y.jsx)("div",{children:a.map((function(e){return Object(y.jsx)(Z.a,{bg:"light",children:Object(y.jsxs)(Z.a.Body,{children:[Object(y.jsx)(Z.a.Title,{children:e.title}),Object(y.jsx)(Z.a.Text,{children:e.body})]})},e.id)}))}):Object(y.jsx)("div",{children:"No post was found."}):Object(y.jsx)("div",{children:"You don't have access to this page"})};n(46);var ee=function(){var e=Object(c.useContext)(k).setToken,t=function(){var t=Object(i.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("keycloak tokens: ",n),e(n?n.token:void 0,B);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(y.jsx)(m.a,{authClient:B,initOptions:{onLoad:"check-sso"},onTokens:t,onEvent:function(e,t){console.log("onKeycloakEvent",e,t||"")},children:Object(y.jsxs)(R.a,{children:[Object(y.jsx)(Y,{}),Object(y.jsxs)(z.a,{style:{marginTop:"20px"},children:[Object(y.jsx)(W.a,{children:Object(y.jsx)(F.a,{children:Object(y.jsx)(Q,{})})}),Object(y.jsx)(W.a,{style:{marginTop:"30px"},children:Object(y.jsx)(F.a,{children:Object(y.jsxs)(T.d,{children:[Object(y.jsx)(T.b,{exact:!0,path:"/posts",render:function(e){return Object(y.jsx)($,{})}}),Object(y.jsx)(T.b,{exact:!0,path:"/",render:function(e){return Object(y.jsx)(X,{})}}),Object(y.jsx)(T.a,{to:"/"})]})})})]})]})})};n(88);var te=function(){return Object(y.jsx)(_,{children:Object(y.jsx)(ee,{})})};a.a.render(Object(y.jsx)(o.a.StrictMode,{children:Object(y.jsx)(te,{})}),document.getElementById("root"))}},[[89,1,2]]]);
//# sourceMappingURL=main.8cfe3699.chunk.js.map